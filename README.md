# fencing-scoreboard# fencing-scoreboard
ðŸ¤º Fencing Scoreboard KioskUn sistema segnapunti professionale per la scherma, progettato per girare su Raspberry Pi in modalitÃ  Kiosk.Il sistema offre un display per il pubblico e un telecomando web per l'arbitro (accessibile via Smartphone/Tablet), con sincronizzazione in tempo reale su Google Sheets.âœ¨ FunzionalitÃ  PrincipaliDisplay Kiosk: Interfaccia pulita e ad alto contrasto per il monitor di pedana.Telecomando Web: Controllo totale via QR Code (Cronometro, Punteggi, Cartellini).Sincronizzazione Cloud:Lettura: Carica gli assalti e i gironi direttamente da un Foglio Google.Scrittura: Invia i risultati finali al Foglio Google con verifica automatica.Logica Cartellini Avanzata:Gestione automatica penalitÃ  (Giallo -> Rosso + Punto Avversario).Cartellino Nero con popup di conferma.P-Cards (PassivitÃ ).Gestione Foto: Visualizzazione foto atleti (caricamento massivo o singolo).Auto-Avanzamento: Dopo l'invio del punteggio, il sistema carica automaticamente il prossimo assalto da disputare (0-0).Zero-Manutenzione: Aggiornamento automatico del software ad ogni riavvio del Raspberry.ðŸ› ï¸ Requisiti HardwareRaspberry Pi (modello 3B+ o 4 raccomandato, ma funziona anche su altri).Scheda MicroSD (minimo 8GB) con Raspberry Pi OS (Desktop version).Monitor (HDMI).Connessione Internet (WiFi o Ethernet).ðŸš€ Installazione (Primo Avvio)La procedura Ã¨ completamente automatizzata.Accendi il Raspberry Pi e apri il Terminale.Scarica lo script di installazione:wget [https://raw.githubusercontent.com/nzo1986/fencing-scoreboard/main/setup_fencing_kiosk.py](https://raw.githubusercontent.com/nzo1986/fencing-scoreboard/main/setup_fencing_kiosk.py)
Esegui lo script:python3 setup_fencing_kiosk.py
Cosa farÃ  lo script:InstallerÃ  tutte le dipendenze di sistema (Chromium, Driver video, ecc.).CreerÃ  l'ambiente Python virtuale e installerÃ  le librerie necessarie.ScaricherÃ  l'ultima versione di questo software.ConfigurerÃ  l'avvio automatico (Autostart).RiavvierÃ  il sistema in modalitÃ  Kiosk a schermo intero.âš™ï¸ Configurazione Google SheetsPer far funzionare la lettura e scrittura dei dati, il tuo Foglio Google deve essere configurato correttamente.1. Struttura del FoglioIl sistema si aspetta due fogli specifici (Tab):display3gir: Contiene la lista degli assalti.Le colonne devono rispettare la mappatura definita nelle Impostazioni (es. A=AtletaSX, B=PuntiSX, C=PuntiDX, D=AtletaDX).Rank: Contiene la lista degli atleti per le foto.I nomi devono essere nella Colonna E (a partire dalla riga 3).2. Attivare lo Script (Apps Script)Per permettere al Raspberry di scrivere i punteggi:Nel tuo Foglio Google, vai su Estensioni > Apps Script.Incolla il codice seguente:function doPost(e) {
  var lock = LockService.getScriptLock();
  try {
    lock.waitLock(10000);
    var jsonString = e.postData.contents;
    var data = JSON.parse(jsonString);
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(data.sheet_name);

    if (!sheet) return ContentService.createTextOutput(JSON.stringify({"status":"error", "message": "Foglio non trovato"}));

    sheet.getRange(parseInt(data.row), parseInt(data.col_sx)).setValue(data.val_sx);
    sheet.getRange(parseInt(data.row), parseInt(data.col_dx)).setValue(data.val_dx);

    return ContentService.createTextOutput(JSON.stringify({"status":"success"}));
  } catch (err) {
    return ContentService.createTextOutput(JSON.stringify({"status":"error", "message": err.toString()}));
  } finally {
    lock.releaseLock();
  }
}
Clicca "Esegui il deployment" > "Nuovo deployment".Seleziona "Applicazione web".IMPORTANTE: Imposta "Chi puÃ² accedere" su "Chiunque" (Anyone).Copia l'URL generato (finisce con /exec).Incolla questo URL nelle Impostazioni del Segnapunti (icona ingranaggio sul telecomando).ðŸ“± Guida all'UsoCollegamento al TelecomandoCollega il tuo smartphone alla stessa rete WiFi del Raspberry.Inquadra il QR Code che appare sul monitor all'avvio (o digita l'IP mostrato).Gestione AssaltiNel telecomando, seleziona il Girone (es. "Rosso").Apri il menu a tendina in basso e seleziona l'assalto da caricare.Il display si aggiornerÃ  con i nomi e le foto.Inserimento Punti e InvioUsa i tasti + e - per i punti.Usa i tasti G (Giallo), R (Rosso), N (Nero), P per i cartellini.Nota: Un cartellino Rosso assegna automaticamente un punto all'avversario.A fine assalto, clicca su INVIA.ðŸ”µ Spia Blu: Invio in corso.ðŸŸ¡ Spia Gialla: Verifica dati sul foglio (tentativo 1 o 2).ðŸŸ¢ Spia Verde: Dati confermati su Google Sheets!ðŸ”´ Spia Rossa: Errore (riprovare).Se l'invio ha successo, il sistema caricherÃ  automaticamente il prossimo assalto 0-0 del girone.ðŸ“¸ Gestione FotoVai nel menu Impostazioni > Gestione Foto Atleti.Puoi caricare un singolo file o usare il Maxi Upload.I file devono chiamarsi come l'atleta (es. ROSSI MARIO.jpg o Rossi_Mario.png). Il sistema pulisce automaticamente i nomi per trovare la corrispondenza.ðŸ”„ AggiornamentiIl sistema Ã¨ configurato per aggiornarsi da solo.Per ottenere l'ultima versione del codice, basta riavviare il Raspberry (sudo reboot o stacca/attacca corrente).All'avvio, una finestra nera controllerÃ  le modifiche su GitHub e le scaricherÃ  prima di lanciare il programma.